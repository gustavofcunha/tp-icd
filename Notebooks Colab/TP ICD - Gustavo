{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"0US-UUJ21Acl","outputId":"dcb76006-eedb-4137-d552-f65a56a4d036","executionInfo":{"status":"ok","timestamp":1686057332797,"user_tz":180,"elapsed":34693,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting basedosdados\n","  Downloading basedosdados-1.6.11-py3-none-any.whl (51 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m51.1/51.1 kB\u001b[0m \u001b[31m4.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting Jinja2==3.0.3 (from basedosdados)\n","  Downloading Jinja2-3.0.3-py3-none-any.whl (133 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m133.6/133.6 kB\u001b[0m \u001b[31m10.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting ckanapi==4.6 (from basedosdados)\n","  Downloading ckanapi-4.6.tar.gz (32 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting click==8.0.3 (from basedosdados)\n","  Downloading click-8.0.3-py3-none-any.whl (97 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m97.5/97.5 kB\u001b[0m \u001b[31m13.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting google-cloud-bigquery==2.30.1 (from basedosdados)\n","  Downloading google_cloud_bigquery-2.30.1-py2.py3-none-any.whl (203 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m204.0/204.0 kB\u001b[0m \u001b[31m25.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting google-cloud-bigquery-storage==1.1.0 (from basedosdados)\n","  Downloading google_cloud_bigquery_storage-1.1.0-py2.py3-none-any.whl (135 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m135.2/135.2 kB\u001b[0m \u001b[31m14.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting google-cloud-storage==1.42.3 (from basedosdados)\n","  Downloading google_cloud_storage-1.42.3-py2.py3-none-any.whl (105 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m106.0/106.0 kB\u001b[0m \u001b[31m10.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting importlib-metadata<5.0.0,>=4.11.3 (from basedosdados)\n","  Downloading importlib_metadata-4.13.0-py3-none-any.whl (23 kB)\n","Collecting loguru<0.7.0,>=0.6.0 (from basedosdados)\n","  Downloading loguru-0.6.0-py3-none-any.whl (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m5.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas<2.0.0,>=1.3.5 in /usr/local/lib/python3.10/dist-packages (from basedosdados) (1.5.3)\n","Requirement already satisfied: pandas-gbq<0.18.0,>=0.17.4 in /usr/local/lib/python3.10/dist-packages (from basedosdados) (0.17.9)\n","Collecting pandavro<2.0.0,>=1.6.0 (from basedosdados)\n","  Downloading pandavro-1.7.2-py3-none-any.whl (8.8 kB)\n","Collecting pyaml==20.4.0 (from basedosdados)\n","  Downloading pyaml-20.4.0-py2.py3-none-any.whl (17 kB)\n","Collecting pyarrow==6.0.0 (from basedosdados)\n","  Downloading pyarrow-6.0.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m25.6/25.6 MB\u001b[0m \u001b[31m38.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting ruamel.yaml==0.17.10 (from basedosdados)\n","  Downloading ruamel.yaml-0.17.10-py3-none-any.whl (108 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m108.4/108.4 kB\u001b[0m \u001b[31m7.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting shapely<2.0.0,>=1.6.0 (from basedosdados)\n","  Downloading Shapely-1.8.5.post1-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (2.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.0/2.0 MB\u001b[0m \u001b[31m35.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: toml<0.11.0,>=0.10.2 in /usr/local/lib/python3.10/dist-packages (from basedosdados) (0.10.2)\n","Collecting tomlkit==0.7.0 (from basedosdados)\n","  Downloading tomlkit-0.7.0-py2.py3-none-any.whl (32 kB)\n","Collecting tqdm==4.50.2 (from basedosdados)\n","  Downloading tqdm-4.50.2-py2.py3-none-any.whl (70 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m70.9/70.9 kB\u001b[0m \u001b[31m8.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from ckanapi==4.6->basedosdados) (67.7.2)\n","Collecting docopt (from ckanapi==4.6->basedosdados)\n","  Downloading docopt-0.6.2.tar.gz (25 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from ckanapi==4.6->basedosdados) (2.27.1)\n","Requirement already satisfied: python-slugify>=1.0 in /usr/local/lib/python3.10/dist-packages (from ckanapi==4.6->basedosdados) (8.0.1)\n","Requirement already satisfied: six<2.0,>=1.9 in /usr/local/lib/python3.10/dist-packages (from ckanapi==4.6->basedosdados) (1.16.0)\n","Requirement already satisfied: grpcio<2.0dev,>=1.38.1 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (1.54.0)\n","Requirement already satisfied: google-api-core[grpc]<3.0.0dev,>=1.29.0 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (2.11.0)\n","Requirement already satisfied: proto-plus>=1.10.0 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (1.22.2)\n","Requirement already satisfied: google-cloud-core<3.0.0dev,>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (2.3.2)\n","Requirement already satisfied: google-resumable-media<3.0dev,>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (2.5.0)\n","Requirement already satisfied: packaging>=14.3 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (23.1)\n","Requirement already satisfied: protobuf>=3.12.0 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (3.20.3)\n","Requirement already satisfied: python-dateutil<3.0dev,>=2.7.2 in /usr/local/lib/python3.10/dist-packages (from google-cloud-bigquery==2.30.1->basedosdados) (2.8.2)\n","Collecting google-api-core[grpc]<3.0.0dev,>=1.29.0 (from google-cloud-bigquery==2.30.1->basedosdados)\n","  Downloading google_api_core-1.34.0-py3-none-any.whl (120 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m120.2/120.2 kB\u001b[0m \u001b[31m14.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: google-auth<3.0dev,>=1.25.0 in /usr/local/lib/python3.10/dist-packages (from google-cloud-storage==1.42.3->basedosdados) (2.17.3)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from Jinja2==3.0.3->basedosdados) (2.1.2)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.10/dist-packages (from pyaml==20.4.0->basedosdados) (6.0)\n","Requirement already satisfied: numpy>=1.16.6 in /usr/local/lib/python3.10/dist-packages (from pyarrow==6.0.0->basedosdados) (1.22.4)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata<5.0.0,>=4.11.3->basedosdados) (3.15.0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas<2.0.0,>=1.3.5->basedosdados) (2022.7.1)\n","Requirement already satisfied: db-dtypes<2.0.0,>=0.3.1 in /usr/local/lib/python3.10/dist-packages (from pandas-gbq<0.18.0,>=0.17.4->basedosdados) (1.1.1)\n","Requirement already satisfied: pydata-google-auth in /usr/local/lib/python3.10/dist-packages (from pandas-gbq<0.18.0,>=0.17.4->basedosdados) (1.7.0)\n","Requirement already satisfied: google-auth-oauthlib>=0.0.1 in /usr/local/lib/python3.10/dist-packages (from pandas-gbq<0.18.0,>=0.17.4->basedosdados) (1.0.0)\n","Collecting fastavro~=1.5.1 (from pandavro<2.0.0,>=1.6.0->basedosdados)\n","  Downloading fastavro-1.5.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.6/2.6 MB\u001b[0m \u001b[31m29.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: googleapis-common-protos<2.0dev,>=1.56.2 in /usr/local/lib/python3.10/dist-packages (from google-api-core[grpc]<3.0.0dev,>=1.29.0->google-cloud-bigquery==2.30.1->basedosdados) (1.59.0)\n","Requirement already satisfied: grpcio-status<2.0dev,>=1.33.2 in /usr/local/lib/python3.10/dist-packages (from google-api-core[grpc]<3.0.0dev,>=1.29.0->google-cloud-bigquery==2.30.1->basedosdados) (1.48.2)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3.0dev,>=1.25.0->google-cloud-storage==1.42.3->basedosdados) (5.3.0)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3.0dev,>=1.25.0->google-cloud-storage==1.42.3->basedosdados) (0.3.0)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3.0dev,>=1.25.0->google-cloud-storage==1.42.3->basedosdados) (4.9)\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib>=0.0.1->pandas-gbq<0.18.0,>=0.17.4->basedosdados) (1.3.1)\n","Requirement already satisfied: google-crc32c<2.0dev,>=1.0 in /usr/local/lib/python3.10/dist-packages (from google-resumable-media<3.0dev,>=0.6.0->google-cloud-bigquery==2.30.1->basedosdados) (1.5.0)\n","Requirement already satisfied: text-unidecode>=1.3 in /usr/local/lib/python3.10/dist-packages (from python-slugify>=1.0->ckanapi==4.6->basedosdados) (1.3)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->ckanapi==4.6->basedosdados) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->ckanapi==4.6->basedosdados) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->ckanapi==4.6->basedosdados) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->ckanapi==4.6->basedosdados) (3.4)\n","Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3.0dev,>=1.25.0->google-cloud-storage==1.42.3->basedosdados) (0.5.0)\n","Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib>=0.0.1->pandas-gbq<0.18.0,>=0.17.4->basedosdados) (3.2.2)\n","Building wheels for collected packages: ckanapi, docopt\n","  Building wheel for ckanapi (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for ckanapi: filename=ckanapi-4.6-py3-none-any.whl size=40683 sha256=40acba22036e53427363408c1e1adc9ff1dbab84d743cd86d67c42ae3f295df5\n","  Stored in directory: /root/.cache/pip/wheels/64/30/93/f9c2ebf4e93dc7b6abd5e376cdee291a6541ee504ac6ec4062\n","  Building wheel for docopt (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for docopt: filename=docopt-0.6.2-py2.py3-none-any.whl size=13707 sha256=fef8502536ab04876b5c3d7517b2b06c3b9abd8b39f535e01ac89958dd69b493\n","  Stored in directory: /root/.cache/pip/wheels/fc/ab/d4/5da2067ac95b36618c629a5f93f809425700506f72c9732fac\n","Successfully built ckanapi docopt\n","Installing collected packages: docopt, tqdm, tomlkit, shapely, ruamel.yaml, pyarrow, pyaml, loguru, Jinja2, importlib-metadata, fastavro, click, ckanapi, pandavro, google-api-core, google-cloud-storage, google-cloud-bigquery-storage, google-cloud-bigquery, basedosdados\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.65.0\n","    Uninstalling tqdm-4.65.0:\n","      Successfully uninstalled tqdm-4.65.0\n","  Attempting uninstall: shapely\n","    Found existing installation: shapely 2.0.1\n","    Uninstalling shapely-2.0.1:\n","      Successfully uninstalled shapely-2.0.1\n","  Attempting uninstall: pyarrow\n","    Found existing installation: pyarrow 9.0.0\n","    Uninstalling pyarrow-9.0.0:\n","      Successfully uninstalled pyarrow-9.0.0\n","  Attempting uninstall: Jinja2\n","    Found existing installation: Jinja2 3.1.2\n","    Uninstalling Jinja2-3.1.2:\n","      Successfully uninstalled Jinja2-3.1.2\n","  Attempting uninstall: click\n","    Found existing installation: click 8.1.3\n","    Uninstalling click-8.1.3:\n","      Successfully uninstalled click-8.1.3\n","  Attempting uninstall: google-api-core\n","    Found existing installation: google-api-core 2.11.0\n","    Uninstalling google-api-core-2.11.0:\n","      Successfully uninstalled google-api-core-2.11.0\n","  Attempting uninstall: google-cloud-storage\n","    Found existing installation: google-cloud-storage 2.8.0\n","    Uninstalling google-cloud-storage-2.8.0:\n","      Successfully uninstalled google-cloud-storage-2.8.0\n","  Attempting uninstall: google-cloud-bigquery-storage\n","    Found existing installation: google-cloud-bigquery-storage 2.19.1\n","    Uninstalling google-cloud-bigquery-storage-2.19.1:\n","      Successfully uninstalled google-cloud-bigquery-storage-2.19.1\n","  Attempting uninstall: google-cloud-bigquery\n","    Found existing installation: google-cloud-bigquery 3.9.0\n","    Uninstalling google-cloud-bigquery-3.9.0:\n","      Successfully uninstalled google-cloud-bigquery-3.9.0\n","Successfully installed Jinja2-3.0.3 basedosdados-1.6.11 ckanapi-4.6 click-8.0.3 docopt-0.6.2 fastavro-1.5.4 google-api-core-1.34.0 google-cloud-bigquery-2.30.1 google-cloud-bigquery-storage-1.1.0 google-cloud-storage-1.42.3 importlib-metadata-4.13.0 loguru-0.6.0 pandavro-1.7.2 pyaml-20.4.0 pyarrow-6.0.0 ruamel.yaml-0.17.10 shapely-1.8.5.post1 tomlkit-0.7.0 tqdm-4.50.2\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["google"]}}},"metadata":{}}],"source":["! pip install basedosdados"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4eaghQoKyVn3","executionInfo":{"status":"ok","timestamp":1686057427713,"user_tz":180,"elapsed":94923,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}},"outputId":"d74d1a1b-9f90-4816-bec1-435150c60254"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","import basedosdados as bd"],"metadata":{"id":"3I3Rw68F6LgV","executionInfo":{"status":"ok","timestamp":1686057429331,"user_tz":180,"elapsed":1622,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["#base municipios amazonia legal\n","df_municipios_amazonia_legal = pd.read_csv('/content/drive/MyDrive/UFMG/Períodos/6-periodo/ICD/TP/lista_de_municipios_Amazonia_Legal_2021 - Planilha1.csv')\n","df_municipios_amazonia_legal.head(1000)\n","\n","#772 municipios"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":606},"id":"UTp9YAYs4XOA","executionInfo":{"status":"ok","timestamp":1686057430964,"user_tz":180,"elapsed":1635,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}},"outputId":"39c14fe8-8bf9-410d-dca2-34b293f43cf4"},"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        NM_REGIAO  CD_UF        NM_UF SIGLA   CD_MUN                 NM_MUN  \\\n","0           Norte     11     Rondônia    RO  1100015  Alta Floresta D'Oeste   \n","1           Norte     11     Rondônia    RO  1100023              Ariquemes   \n","2           Norte     11     Rondônia    RO  1100031                 Cabixi   \n","3           Norte     11     Rondônia    RO  1100049                 Cacoal   \n","4           Norte     11     Rondônia    RO  1100056             Cerejeiras   \n","..            ...    ...          ...   ...      ...                    ...   \n","767  Centro-oeste     51  Mato Grosso    MT  5108600              Vila Rica   \n","768  Centro-oeste     51  Mato Grosso    MT  5108808           Nova Guarita   \n","769  Centro-oeste     51  Mato Grosso    MT  5108857        Nova Marilândia   \n","770  Centro-oeste     51  Mato Grosso    MT  5108907           Nova Maringá   \n","771  Centro-oeste     51  Mato Grosso    MT  5108956       Nova Monte Verde   \n","\n","      AREA_TOT   AREA_INT PERC_INT LAT_SEDE LNG_SEDE SEDE_AL  Unnamed: 12  \\\n","0     7.067,13   7.067,13      100   -11,93   -62,00     sim          NaN   \n","1     4.426,57   4.426,57      100    -9,91   -63,03     sim          NaN   \n","2     1.314,35   1.314,35      100   -13,49   -60,54     sim          NaN   \n","3     3.793,00   3.793,00      100   -11,44   -61,45     sim          NaN   \n","4     2.783,30   2.783,30      100   -13,19   -60,82     sim          NaN   \n","..         ...        ...      ...      ...      ...     ...          ...   \n","767   7.436,38   7.436,38      100   -10,01   -51,11     sim          NaN   \n","768   1.121,93   1.121,93      100   -10,31   -55,40     sim          NaN   \n","769   1.905,74   1.905,74      100   -14,36   -56,97     sim          NaN   \n","770  11.553,48  11.553,48      100   -13,04   -57,09     sim          NaN   \n","771   5.139,31   5.139,31      100    -9,98   -57,47     sim          NaN   \n","\n","    Unnamed: 13 Unnamed: 14                        Unnamed: 15  \n","0           NaN         NaN                                NaN  \n","1           NaN         NaN                                NaN  \n","2       LEGENDA         NaN                                NaN  \n","3             1   NM_REGIAO                     Nome da Região  \n","4             2       CD_UF  Geocódigo da Unidade da Federação  \n","..          ...         ...                                ...  \n","767         NaN         NaN                                NaN  \n","768         NaN         NaN                                NaN  \n","769         NaN         NaN                                NaN  \n","770         NaN         NaN                                NaN  \n","771         NaN         NaN                                NaN  \n","\n","[772 rows x 16 columns]"],"text/html":["\n","  <div id=\"df-242d854a-2751-4988-a9f2-d405aa595562\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>NM_REGIAO</th>\n","      <th>CD_UF</th>\n","      <th>NM_UF</th>\n","      <th>SIGLA</th>\n","      <th>CD_MUN</th>\n","      <th>NM_MUN</th>\n","      <th>AREA_TOT</th>\n","      <th>AREA_INT</th>\n","      <th>PERC_INT</th>\n","      <th>LAT_SEDE</th>\n","      <th>LNG_SEDE</th>\n","      <th>SEDE_AL</th>\n","      <th>Unnamed: 12</th>\n","      <th>Unnamed: 13</th>\n","      <th>Unnamed: 14</th>\n","      <th>Unnamed: 15</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Norte</td>\n","      <td>11</td>\n","      <td>Rondônia</td>\n","      <td>RO</td>\n","      <td>1100015</td>\n","      <td>Alta Floresta D'Oeste</td>\n","      <td>7.067,13</td>\n","      <td>7.067,13</td>\n","      <td>100</td>\n","      <td>-11,93</td>\n","      <td>-62,00</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Norte</td>\n","      <td>11</td>\n","      <td>Rondônia</td>\n","      <td>RO</td>\n","      <td>1100023</td>\n","      <td>Ariquemes</td>\n","      <td>4.426,57</td>\n","      <td>4.426,57</td>\n","      <td>100</td>\n","      <td>-9,91</td>\n","      <td>-63,03</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Norte</td>\n","      <td>11</td>\n","      <td>Rondônia</td>\n","      <td>RO</td>\n","      <td>1100031</td>\n","      <td>Cabixi</td>\n","      <td>1.314,35</td>\n","      <td>1.314,35</td>\n","      <td>100</td>\n","      <td>-13,49</td>\n","      <td>-60,54</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>LEGENDA</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Norte</td>\n","      <td>11</td>\n","      <td>Rondônia</td>\n","      <td>RO</td>\n","      <td>1100049</td>\n","      <td>Cacoal</td>\n","      <td>3.793,00</td>\n","      <td>3.793,00</td>\n","      <td>100</td>\n","      <td>-11,44</td>\n","      <td>-61,45</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>NM_REGIAO</td>\n","      <td>Nome da Região</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Norte</td>\n","      <td>11</td>\n","      <td>Rondônia</td>\n","      <td>RO</td>\n","      <td>1100056</td>\n","      <td>Cerejeiras</td>\n","      <td>2.783,30</td>\n","      <td>2.783,30</td>\n","      <td>100</td>\n","      <td>-13,19</td>\n","      <td>-60,82</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>2</td>\n","      <td>CD_UF</td>\n","      <td>Geocódigo da Unidade da Federação</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>767</th>\n","      <td>Centro-oeste</td>\n","      <td>51</td>\n","      <td>Mato Grosso</td>\n","      <td>MT</td>\n","      <td>5108600</td>\n","      <td>Vila Rica</td>\n","      <td>7.436,38</td>\n","      <td>7.436,38</td>\n","      <td>100</td>\n","      <td>-10,01</td>\n","      <td>-51,11</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>768</th>\n","      <td>Centro-oeste</td>\n","      <td>51</td>\n","      <td>Mato Grosso</td>\n","      <td>MT</td>\n","      <td>5108808</td>\n","      <td>Nova Guarita</td>\n","      <td>1.121,93</td>\n","      <td>1.121,93</td>\n","      <td>100</td>\n","      <td>-10,31</td>\n","      <td>-55,40</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>769</th>\n","      <td>Centro-oeste</td>\n","      <td>51</td>\n","      <td>Mato Grosso</td>\n","      <td>MT</td>\n","      <td>5108857</td>\n","      <td>Nova Marilândia</td>\n","      <td>1.905,74</td>\n","      <td>1.905,74</td>\n","      <td>100</td>\n","      <td>-14,36</td>\n","      <td>-56,97</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>770</th>\n","      <td>Centro-oeste</td>\n","      <td>51</td>\n","      <td>Mato Grosso</td>\n","      <td>MT</td>\n","      <td>5108907</td>\n","      <td>Nova Maringá</td>\n","      <td>11.553,48</td>\n","      <td>11.553,48</td>\n","      <td>100</td>\n","      <td>-13,04</td>\n","      <td>-57,09</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>771</th>\n","      <td>Centro-oeste</td>\n","      <td>51</td>\n","      <td>Mato Grosso</td>\n","      <td>MT</td>\n","      <td>5108956</td>\n","      <td>Nova Monte Verde</td>\n","      <td>5.139,31</td>\n","      <td>5.139,31</td>\n","      <td>100</td>\n","      <td>-9,98</td>\n","      <td>-57,47</td>\n","      <td>sim</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>772 rows × 16 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-242d854a-2751-4988-a9f2-d405aa595562')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-242d854a-2751-4988-a9f2-d405aa595562 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-242d854a-2751-4988-a9f2-d405aa595562');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}]},{"cell_type":"code","execution_count":5,"metadata":{"id":"Z3ztopoXEWFH","colab":{"base_uri":"https://localhost:8080/","height":380},"executionInfo":{"status":"error","timestamp":1686057561382,"user_tz":180,"elapsed":130424,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}},"outputId":"e1ce79ef-4e0e-4210-cf54-c115e0a8c6eb"},"outputs":[{"output_type":"error","ename":"MessageError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mMessageError\u001b[0m                              Traceback (most recent call last)","\u001b[0;32m<ipython-input-5-fb20de7f7e7d>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m#base taxa de desmatamento\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mdf_desmatamento\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mbd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_table\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdataset_id\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'br_inpe_prodes'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtable_id\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'desmatamento_municipio'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbilling_project_id\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"capable-net-174303\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0mdf_desmatamento\u001b[0m  \u001b[0;34m=\u001b[0m \u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'ano'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m>=\u001b[0m \u001b[0;36m2016\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m&\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'ano'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m<=\u001b[0m \u001b[0;36m2019\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'taxa_desmatamento'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'desmatado'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m/\u001b[0m\u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'area'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mdf_desmatamento\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf_desmatamento\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'ano'\u001b[0m\u001b[0;34m,\u001b[0m       \u001b[0;34m'id_municipio'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'taxa_desmatamento'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/basedosdados/download/download.py\u001b[0m in \u001b[0;36mread_table\u001b[0;34m(dataset_id, table_id, billing_project_id, query_project_id, limit, from_file, reauth, use_bqstorage_api)\u001b[0m\n\u001b[1;32m    161\u001b[0m         \u001b[0;32mraise\u001b[0m \u001b[0mBaseDosDadosException\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Both table_id and dataset_id should be filled.\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    162\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 163\u001b[0;31m     return read_sql(\n\u001b[0m\u001b[1;32m    164\u001b[0m         \u001b[0mquery\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    165\u001b[0m         \u001b[0mbilling_project_id\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbilling_project_id\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/basedosdados/download/download.py\u001b[0m in \u001b[0;36mread_sql\u001b[0;34m(query, billing_project_id, from_file, reauth, use_bqstorage_api)\u001b[0m\n\u001b[1;32m     82\u001b[0m         return pandas_gbq.read_gbq(\n\u001b[1;32m     83\u001b[0m             \u001b[0mquery\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 84\u001b[0;31m             \u001b[0mcredentials\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcredentials\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfrom_file\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfrom_file\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreauth\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mreauth\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     85\u001b[0m             \u001b[0mproject_id\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbilling_project_id\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     86\u001b[0m             \u001b[0muse_bqstorage_api\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0muse_bqstorage_api\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/basedosdados/download/base.py\u001b[0m in \u001b[0;36mcredentials\u001b[0;34m(from_file, reauth)\u001b[0m\n\u001b[1;32m     38\u001b[0m         \u001b[0;32mfrom\u001b[0m \u001b[0mgoogle\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolab\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mauth\u001b[0m  \u001b[0;31m# pylint: disable=import-outside-toplevel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 40\u001b[0;31m         \u001b[0mauth\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mauthenticate_user\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     41\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     42\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/auth.py\u001b[0m in \u001b[0;36mauthenticate_user\u001b[0;34m(clear_output, project_id)\u001b[0m\n\u001b[1;32m    279\u001b[0m   \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0m_check_adc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0m_CredentialType\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mUSER\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    280\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0muse_auth_ephem\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 281\u001b[0;31m       _message.blocking_request(\n\u001b[0m\u001b[1;32m    282\u001b[0m           \u001b[0;34m'request_auth'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    283\u001b[0m           \u001b[0mrequest\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m'authType'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;34m'auth_user_ephemeral'\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/_message.py\u001b[0m in \u001b[0;36mblocking_request\u001b[0;34m(request_type, request, timeout_sec, parent)\u001b[0m\n\u001b[1;32m    174\u001b[0m       \u001b[0mrequest_type\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrequest\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparent\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mparent\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mexpect_reply\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    175\u001b[0m   )\n\u001b[0;32m--> 176\u001b[0;31m   \u001b[0;32mreturn\u001b[0m \u001b[0mread_reply_from_input\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrequest_id\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtimeout_sec\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/google/colab/_message.py\u001b[0m in \u001b[0;36mread_reply_from_input\u001b[0;34m(message_id, timeout_sec)\u001b[0m\n\u001b[1;32m    101\u001b[0m     ):\n\u001b[1;32m    102\u001b[0m       \u001b[0;32mif\u001b[0m \u001b[0;34m'error'\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mreply\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 103\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mMessageError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mreply\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'error'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    104\u001b[0m       \u001b[0;32mreturn\u001b[0m \u001b[0mreply\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'data'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    105\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mMessageError\u001b[0m: Error: credential propagation was unsuccessful"]}],"source":["#base taxa de desmatamento\n","df_desmatamento = bd.read_table(dataset_id='br_inpe_prodes', table_id='desmatamento_municipio', billing_project_id=\"capable-net-174303\")\n","df_desmatamento  = df_desmatamento[(df_desmatamento['ano'] >= 2016) & (df_desmatamento['ano'] <= 2019)]\n","df_desmatamento['taxa_desmatamento'] = df_desmatamento['desmatado']/df_desmatamento['area']\n","df_desmatamento = df_desmatamento[['ano',\t'id_municipio', 'taxa_desmatamento']]\n","\n","#restringindo a municipios da amazonia legal e ano 2019\n","df_desmatamento['id_municipio'] = df_desmatamento['id_municipio'].astype(int)\n","df_desmatamento_amazonia_legal = df_desmatamento.merge(df_municipios_amazonia_legal, left_on='id_municipio', right_on='CD_MUN', how='inner')\n","df_desmatamento_amazonia_legal['ano'] = df_desmatamento_amazonia_legal['ano'].astype(int)\n","df_desmatamento_amazonia_legal_2019 = df_desmatamento_amazonia_legal.query('ano == 2019')\n","df_desmatamento_amazonia_legal_2019 = df_desmatamento_amazonia_legal_2019[['id_municipio', 'taxa_desmatamento']]\n","df_desmatamento_amazonia_legal_2019.rename(columns={'taxa_desmatamento': 'taxa_desmatamento_2019'}, inplace=True)\n","\n","df_desmatamento_amazonia_legal_2019.head(1000)"]},{"cell_type":"code","source":["#base taxa de homicidios/100000 em 2019\n","df_homicidios = pd.read_csv('/content/drive/MyDrive/UFMG/Períodos/6-periodo/ICD/TP/taxa-homicidios-2000-01-15-2019-01-15.csv', sep = \";\")\n","df_homicidios  = df_homicidios[(df_homicidios['período'] == 2019)]\n","df_homicidios_amazonia_legal_2019 = df_homicidios.merge(df_municipios_amazonia_legal, left_on='cod', right_on='CD_MUN', how='inner')\n","df_homicidios_amazonia_legal_2019.rename(columns={'valor': 'taxa_homicidios_2019'}, inplace=True)\n","df_homicidios_amazonia_legal_2019 = df_homicidios_amazonia_legal_2019[['cod', 'taxa_homicidios_2019']]\n","\n","#normalizando taxa_homicidios_2019\n","coluna_min = df_homicidios_amazonia_legal_2019['taxa_homicidios_2019'].min()\n","coluna_max = df_homicidios_amazonia_legal_2019['taxa_homicidios_2019'].max()\n","df_homicidios_amazonia_legal_2019['taxa_homicidios_2019'] = (df_homicidios_amazonia_legal_2019['taxa_homicidios_2019'] - coluna_min) / (coluna_max - coluna_min)\n","\n","\n","df_homicidios_amazonia_legal_2019.head(1000)"],"metadata":{"id":"Bu_7QTX23zyh","executionInfo":{"status":"aborted","timestamp":1686057561383,"user_tz":180,"elapsed":5,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#juntando as duas bases\n","df_desmatamento_homicidios_2019 = df_homicidios_amazonia_legal_2019.merge(df_desmatamento_amazonia_legal_2019, left_on='cod', right_on='id_municipio', how='inner')\n","df_desmatamento_homicidios_2019 = df_desmatamento_homicidios_2019[['id_municipio', 'taxa_homicidios_2019', 'taxa_desmatamento_2019']]\n","df_desmatamento_homicidios_2019.head(1000)"],"metadata":{"id":"6hveECgv6WaN","executionInfo":{"status":"aborted","timestamp":1686057561383,"user_tz":180,"elapsed":4,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import matplotlib.pyplot as plt\n","\n","df_desmatamento_homicidios_2019.plot.scatter(x='taxa_homicidios_2019', y='taxa_desmatamento_2019')\n","plt.show()"],"metadata":{"id":"dn6jHqkP7SIb","executionInfo":{"status":"aborted","timestamp":1686057561384,"user_tz":180,"elapsed":5,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import pandas as pd\n","import seaborn as sns\n","\n","df = df_desmatamento_homicidios_2019\n","\n","# Remover linhas com valores não numéricos nas colunas 'x' e 'y'\n","df = df[pd.to_numeric(df['taxa_homicidios_2019'], errors='coerce').notnull()]\n","df = df[pd.to_numeric(df['taxa_desmatamento_2019'], errors='coerce').notnull()]\n","\n","# Converter as colunas 'x' e 'y' para o tipo numérico\n","df['taxa_homicidios_2019'] = pd.to_numeric(df['taxa_homicidios_2019'])\n","df['taxa_desmatamento_2019'] = pd.to_numeric(df['taxa_desmatamento_2019'])\n","\n","# Plotar o gráfico de dispersão com linha de regressão\n","sns.regplot(x='taxa_homicidios_2019', y='taxa_desmatamento_2019', data=df)\n","plt.show()"],"metadata":{"id":"jlIUMBcG-0om","executionInfo":{"status":"aborted","timestamp":1686057561384,"user_tz":180,"elapsed":5,"user":{"displayName":"Gustavo Cunha","userId":"13383356618015202374"}}},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1TR0UVEj52S4z7tiCbSG76HqcIWWxVfLE","timestamp":1686057196490}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}